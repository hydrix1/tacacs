#!/tmp/tacacs/sbin/tac_plus

id = spawnd {
	listen = { port = 4901 }
	spawn = {
		instances min = 1
		instances max = 10
	}
	background = no
}

id = tac_plus {
	debug = PACKET AUTHEN AUTHOR ALL

	access log = ../output/access_4901.log
	accounting log = ../output/acct_4901.log

        key = cisco

	user = cisco {
		password = clear cisco
		service = shell {
			default cmd = permit
		}
	}

	user = test_4901_a {
		password = clear A4901
		service = shell {
			cmd = write { permit .* }
		}
		service = junos-exec {
			set local-user-name = let_me_in
		}
	}

	user = test_4901_b {
		password = permit
		service = shell {
			cmd = write { permit .* }
		}
		service = junos-exec {
			set local-user-name = let_me_in
		}
	}

	user = test_4901_c {
		password = deny
		service = shell {
			cmd = write { permit .* }
		}
	}
}
